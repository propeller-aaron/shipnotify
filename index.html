<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShipNotify - Package Tracking Service | Propeller Inc.</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0d3c55 0%, #1e648c 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 100%;
            padding: 40px;
            text-align: center;
        }

        .logo {
            font-size: 2.5em;
            font-weight: bold;
            color: #0d3c55;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .info {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            color: #555;
            line-height: 1.6;
        }

        .info a {
            color: #0d3c55;
            text-decoration: none;
            font-weight: 600;
        }

        .info a:hover {
            text-decoration: underline;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: #333;
            font-weight: 600;
            text-align: left;
        }

        input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #0d3c55;
        }

        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #0d3c55 0%, #2878aa 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(13, 60, 85, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .error {
            background: #fee;
            color: #c33;
            padding: 12px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }

        .error.show {
            display: block;
        }

        .loading {
            display: none;
            margin-top: 15px;
            color: #0d3c55;
        }

        .loading.show {
            display: block;
        }

        .footer {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            color: #999;
            font-size: 0.9em;
        }

        .footer a {
            color: #0d3c55;
            text-decoration: none;
            font-weight: 600;
        }

        .footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">ðŸ“¦ ShipNotify</div>
        <div class="subtitle">Package Tracking Service</div>
        
        <div class="info">
            <p>ShipNotify is a service provided by <a href="https://propellerinc.com" target="_blank">Propeller Inc.</a> to send notification emails to our customers about their package shipments.</p>
            <p style="margin-top: 15px;">Enter your tracking number below to track your package with the appropriate carrier.</p>
        </div>

        <form id="trackingForm">
            <div class="form-group">
                <label for="trackingNumber">Tracking Number</label>
                <input 
                    type="text" 
                    id="trackingNumber" 
                    name="tracking" 
                    placeholder="Enter your tracking number"
                    autocomplete="off"
                    required
                >
            </div>
            <button type="submit">Track Package</button>
        </form>

        <div class="error" id="errorMessage"></div>
        <div class="loading" id="loadingMessage">Redirecting to carrier...</div>

        <div class="footer">
            <p>Powered by <a href="https://propellerinc.com" target="_blank">Propeller Inc.</a></p>
        </div>
    </div>

    <script>
        // Carrier detection patterns
        const carrierPatterns = {
            fedex: [
                /^\d{12}$/,                                    // 12 digits
                /^\d{15}$/,                                    // 15 digits
                /^[0-9]{4} ?[0-9]{4} ?[0-9]{4}$/,             // 12 digits with spaces
                /^[0-9]{15}$/,                                 // 15 digits
                /^[0-9A-Z]{22}$/,                              // 22 alphanumeric
                /^96\d{20}$/,                                  // Starts with 96 followed by 20 digits
                /^[0-9]{12,14}$/                               // 12-14 digits
            ],
            usps: [
                /^9[0-9]{19,21}$/,                             // 20-22 digits starting with 9
                /^[0-9]{20,22}$/,                              // 20-22 digits
                /^[0-9]{13}$/,                                 // 13 digits
                /^[A-Z]{2}[0-9]{9}[A-Z]{2}$/,                 // 2 letters, 9 digits, 2 letters
                /^[0-9]{26}$/,                                 // 26 digits
                /^[0-9]{10}$/,                                 // 10 digits
                /^[0-9]{11}$/,                                 // 11 digits
                /^[0-9]{16}$/,                                 // 16 digits
                /^[0-9]{22}$/                                  // 22 digits
            ],
            ups: [
                /^1Z[0-9A-Z]{16}$/,                            // Starts with 1Z followed by 16 alphanumeric
                /^[0-9]{11}$/,                                 // 11 digits
                /^[0-9]{18}$/,                                 // 18 digits
                /^T[0-9]{10}$/,                                // Starts with T followed by 10 digits
                /^[0-9]{9}$/                                   // 9 digits
            ],
            dhl: [
                /^[0-9]{10}$/,                                 // 10 digits
                /^[0-9]{11}$/,                                 // 11 digits
                /^[0-9]{12}$/,                                 // 12 digits
                /^[0-9]{14}$/,                                 // 14 digits
                /^[0-9]{16}$/,                                 // 16 digits
                /^[A-Z]{2}[0-9]{9}[A-Z]{2}$/,                 // 2 letters, 9 digits, 2 letters
                /^JD[0-9]{18}$/,                               // Starts with JD followed by 18 digits
                /^[0-9]{8,10}$/                                // 8-10 digits
            ]
        };

        // Carrier tracking URLs
        const carrierUrls = {
            fedex: (tracking) => `https://www.fedex.com/fedextrack/?trknbr=${encodeURIComponent(tracking)}`,
            usps: (tracking) => `https://tools.usps.com/go/TrackConfirmAction?qtc_tLabels1=${encodeURIComponent(tracking)}`,
            ups: (tracking) => `https://www.ups.com/track?tracknum=${encodeURIComponent(tracking)}`,
            dhl: (tracking) => `https://www.dhl.com/en/express/tracking.html?AWB=${encodeURIComponent(tracking)}`
        };

        /**
         * Detect carrier based on tracking number pattern
         */
        function detectCarrier(trackingNumber) {
            // Remove spaces and convert to uppercase for consistent matching
            const cleanTracking = trackingNumber.replace(/\s+/g, '').toUpperCase();

            // Check each carrier's patterns
            for (const [carrier, patterns] of Object.entries(carrierPatterns)) {
                for (const pattern of patterns) {
                    if (pattern.test(cleanTracking)) {
                        return carrier;
                    }
                }
            }

            // Special handling for common patterns
            // FedEx: Often starts with specific prefixes
            if (/^[0-9]{12,15}$/.test(cleanTracking) && cleanTracking.length >= 12) {
                return 'fedex';
            }

            // UPS: Often starts with 1Z
            if (cleanTracking.startsWith('1Z')) {
                return 'ups';
            }

            // USPS: Often longer numbers
            if (/^[0-9]{20,26}$/.test(cleanTracking)) {
                return 'usps';
            }

            // Default: try to guess based on length
            if (cleanTracking.length >= 20) {
                return 'usps';
            } else if (cleanTracking.length >= 12) {
                return 'fedex';
            } else if (cleanTracking.length >= 10) {
                return 'dhl';
            }

            return null;
        }

        /**
         * Redirect to carrier tracking page
         */
        function redirectToCarrier(trackingNumber) {
            const carrier = detectCarrier(trackingNumber);
            const errorDiv = document.getElementById('errorMessage');
            const loadingDiv = document.getElementById('loadingMessage');

            if (!carrier) {
                errorDiv.textContent = 'Unable to determine carrier. Please check your tracking number or visit the carrier\'s website directly.';
                errorDiv.classList.add('show');
                loadingDiv.classList.remove('show');
                return;
            }

            errorDiv.classList.remove('show');
            loadingDiv.classList.add('show');

            const url = carrierUrls[carrier](trackingNumber);
            
            // Small delay to show loading message
            setTimeout(() => {
                window.location.href = url;
            }, 500);
        }

        /**
         * Handle form submission
         */
        document.getElementById('trackingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const trackingNumber = document.getElementById('trackingNumber').value.trim();
            
            if (!trackingNumber) {
                document.getElementById('errorMessage').textContent = 'Please enter a tracking number.';
                document.getElementById('errorMessage').classList.add('show');
                return;
            }

            redirectToCarrier(trackingNumber);
        });

        /**
         * Check for tracking number in URL parameters
         */
        function checkUrlParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            const trackingNumber = urlParams.get('tracking') || urlParams.get('track') || urlParams.get('tn');
            
            if (trackingNumber) {
                // Set the input value
                document.getElementById('trackingNumber').value = trackingNumber;
                // Auto-redirect
                redirectToCarrier(trackingNumber);
            }
        }

        // Check URL parameters on page load
        checkUrlParameters();
    </script>
</body>
</html>